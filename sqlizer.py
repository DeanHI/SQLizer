import timeimport sqlite3from flask import Flask, render_template, requestfrom schema_create import create_store_schema, insert_initial_valuesfrom site_navigation import *from edit_navigation import *from delete_navigation import *from insert_navigation import *from app import app#https://upload.wikimedia.org/wikipedia/commons/b/bc/Nikola_Tesla_holding_in_his_hands_balls_of_flame.gif@app.route('/viewallproducts')def view_all_tables():	import sqlite3		sqlite_file = 'inventory_schema'		con = sqlite3.connect(sqlite_file)	c = con.cursor()		c.execute("select name from sqlite_master where name != 'sqlite_sequence'")	all_tables = [str(i)[2:-3] for i in c.fetchall()]		executor = []	for i in all_tables:		executor.append("select * from " + i + " union all")		executor = " ".join(executor)	executor = executor[:-10]	c.execute("create view AllProducts as " + executor)	c.execute("select * from AllProducts")	allpt = [i for i in c.fetchall()]	one_column = [i[0] for i in c.description]	c.execute("DROP VIEW IF EXISTS AllProducts")	con.close()		return render_template('viewallproducts.html', allpt=allpt, one_column=one_column)@app.route('/<table_name>/code/<code_to_be_executed>', methods=['GET'])def execute_command(code_to_be_executed, table_name):	sqlite_file = 'inventory_schema'		con = sqlite3.connect(sqlite_file)	c = con.cursor()		update_table_gross(table_name)		code = code_to_be_executed		c.execute(code)	con.commit()	con.close()	return render_template('codeexecution.html', code=code, table_name=table_name)def table_dict(table_name):	"""function for returning complete html tables by paramaters passed to table (table name)"""		sqlite_file = 'inventory_schema'		con = sqlite3.connect(sqlite_file)	c = con.cursor()		val_list = []	col_list = []	 	col_list_multiplier = 0			executor = 'select * from ' + table_name	c.execute(executor)	for i in c.fetchall():		col_list_multiplier += 1		val_list.append(i)	for j in c.description:				col_list.append(j[0])		col_list = [col_list]*col_list_multiplier		table_dict = list(map(dict, map(zip, col_list, val_list)))	return table_dict	def update_table_gross(table_name):	"""this is the function to be executed during the code_execute code func,		updating the gross product column after any possible change"""	sqlite_file = 'inventory_schema'		con = sqlite3.connect(sqlite_file)	c = con.cursor()		executor = ('select ProductID from ' + table_name)	c.execute(executor)	indexes = []	for i in c.fetchall():		indexes.append(i[0])	first_index = indexes[0]	last_index = indexes [-1]	executor = 'select * from ' + table_name 	c.execute(executor)		for i in range (first_index, last_index+1):		grosssettable = 'update {tn} set grossproductrevenue = (select\		numofproductsold*productprice from {tn} where productid = {i})\		where productid={i}'.format(i = str(i), tn = table_name)		c.execute(grosssettable)			con.commit()				##################this runs the app so ignore this##############if __name__ == "__main__":	app.run(debug = True)	#product()
